# 小魔仙RAG智能体待办功能与优化列表

## 🚀 高优先级功能

### 本地知识库不存在的处理
- [ ] 添加知识库存在性检查
- [ ] 提供知识库初始化向导
- [ ] 智能提示用户配置正确的知识库路径
- [ ] 支持多种知识库格式（Obsidian、Notion、本地文件夹等）

### 流式处理支持
- [ ] 实现流式响应功能
- [ ] 支持实时输出模型生成过程
- [ ] 优化用户体验，提供更好的等待反馈
- [ ] 处理流式过程中的错误情况

### 检索相关文章片段数量控制
- [ ] 动态调整检索片段数量（TOP_K）
- [ ] 根据查询复杂度智能调整片段数量
- [ ] 提供检索片段数量的配置选项
- [ ] 实现相关性阈值控制

---

## 🔧 功能优化

### 向量数据库优化
- [ ] 实现增量索引功能
- [ ] 添加索引更新时间戳
- [ ] 支持索引的增量更新
- [ ] 优化向量数据库性能

### 检索算法优化
- [ ] 实现多种检索策略（语义检索、关键词检索等）
- [ ] 添加检索结果重排序功能
- [ ] 支持多模态检索（未来扩展）
- [ ] 实现检索结果的多样性控制

### 用户界面改进
- [ ] Web 界面支持
- [ ] 支持多轮对话
- [ ] 添加对话历史记录
- [ ] 实现对话记忆功能

---

## 📊 性能优化

### 响应速度优化
- [ ] 模型推理加速
- [ ] 向量检索优化
- [ ] 缓存机制实现
- [ ] 并发处理支持

### 资源管理
- [ ] 内存使用优化
- [ ] 模型加载优化
- [ ] 连接池管理
- [ ] 资源清理机制

---

## 🛡️ 安全与稳定性

### 安全性增强
- [ ] 输入验证和过滤
- [ ] 防止提示注入攻击
- [ ] API 密钥安全管理
- [ ] 访问控制机制

### 稳定性改进
- [ ] 更完善的错误处理
- [ ] 重试机制优化
- [ ] 健壮性测试
- [ ] 监控和日志改进

---

## 📈 扩展功能

### 知识库管理
- [ ] 知识库同步功能
- [ ] 知识库版本管理
- [ ] 知识库备份与恢复
- [ ] 多知识库支持

### 模型管理
- [ ] 多模型支持
- [ ] 模型切换功能
- [ ] 模型性能比较
- [ ] 模型微调支持

---

## 📋 任务状态说明

- 🚀: 高优先级功能
- 🔧: 功能优化
- 📊: 性能优化
- 🛡️: 安全与稳定性
- 📈: 扩展功能

### 状态标记
- [ ] 未开始
- [O] 进行中
- [x] 已完成
- [-] 已取消

---

## ✅ 已完成功能

### V1.3.0 - 对话历史上下文理解
- [x] **实现对话历史上下文理解功能**
  - 在RAGAgent中添加chat_history属性
  - 实现对话历史的自动记录和管理
  - 支持在查询中传递对话历史给意图识别器
  - 在CLI界面中支持清空对话历史功能

### V1.2.0 - 意图识别功能
- [x] **实现用户意图识别系统**
  - 创建IntentRecognizer类，支持多种意图类型识别
  - 实现基于关键词匹配的初步识别
  - 实现基于LLM的精确意图识别
  - 集成到RAGAgent主流程中
  - 根据意图类型选择不同处理策略

### V1.1.0 - 检索相关性优化
- [x] **解决检索器相关性判断问题** 
  - 实现了基于相似度阈值的文档过滤机制
  - 当没有找到相关文档时，直接使用本地大模型回答
  - 避免将不相关的文档片段传递给模型导致错误结果
  - 更新了Retriever类以分离检索、过滤和格式化逻辑

### 智能回答增强
- [x] 当未找到相关文档时使用本地大模型回答

### 提示词管理重构
- [x] 创建独立的提示词管理模块
- [x] 按功能分类管理提示词模板
- [x] 提高提示词的可维护性

### RAG提示词优化
- [x] 改进RAG提示词模板，更好地处理检索到的文档内容
- [x] 优化文档相关性判断逻辑
